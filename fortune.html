<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã ‚Äî –∫—É–ø–æ–Ω</title>
<style>
:root{
  --bg:#f0f0f3; --card:#f7f7fb; --ink:#2f2f36;
  --shadow:5px 5px 10px #cfcfd6, -5px -5px 10px #ffffff;
  --inset:inset 5px 5px 10px #cfcfd6, inset -5px -5px 10px #ffffff;
  --maxw:428px;
  --accent1:#ffb366; --accent2:#ff6f00;
  --btn-grad-from:#c5113a; --btn-grad-to:#ff6ea9;
}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);
  font:15px/1.4 -apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Arial;
  -webkit-font-smoothing:antialiased;overflow-x:hidden}
.phone{width:min(100vw,var(--maxw));margin:0 auto;min-height:100dvh;background:var(--bg);
  box-shadow:var(--shadow);border-radius:24px;overflow:hidden;display:flex;flex-direction:column}
.status{height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 16px}
.back{display:inline-block;text-decoration:none;font-weight:700;color:#2f2f36;background:#fff;padding:8px 12px;border-radius:12px;box-shadow:var(--shadow)}
.menu-btn{width:48px;height:34px;border:none;border-radius:12px;background:var(--bg);box-shadow:var(--shadow);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:5px;cursor:pointer}
.menu-btn span{width:22px;height:2.5px;background:#000;border-radius:3px}

.wrap{padding:12px 16px 22px}
/* ‚úÖ –ß–Å–†–ù–´–ô –ù–ï–û–ù –î–õ–Ø –ó–ê–ì–û–õ–û–í–ö–ê */
.headline{
  margin:8px 0 6px;font-weight:900;font-size:clamp(22px,6vw,34px);line-height:1.08;
  color:#111;
  text-shadow:0 0 3px rgba(0,0,0,.35), 0 0 8px rgba(0,0,0,.25), 0 0 16px rgba(0,0,0,.2);
}
.sub{margin:4px 0 14px;color:#3c3d46;font-size:14px}

.card{background:var(--card);box-shadow:var(--shadow);border-radius:20px;padding:16px;display:flex;flex-direction:column;gap:14px}

/* –∫–æ–ª–µ—Å–æ */
.wheel-wrap{position:relative;display:flex;align-items:center;justify-content:center;background:var(--bg);
  border-radius:18px;padding:12px;box-shadow:var(--inset)}
/* –ú–ï–ù–¨–®–ï–ï –∫–æ–ª–µ—Å–æ (—É–º–µ–Ω—å—à–∏–ª ~–Ω–∞ 2 —Å–º) */
.wheel-box{width:min(72vw,300px);height:min(72vw,300px);max-width:300px;max-height:300px;position:relative}
/* —É–∫–∞–∑–∞—Ç–µ–ª—å —Å–Ω–∏–∑—É */
.pointer{position:absolute;left:50%;bottom:-6px;transform:translateX(-50%);
  width:0;height:0;border-left:13px solid transparent;border-right:13px solid transparent;border-bottom:22px solid #d28a00;
  filter:drop-shadow(0 2px 0 rgba(0,0,0,.25))}
.bulb{fill:#ffe9a8;stroke:#e1a400;stroke-width:3px;filter:drop-shadow(0 1px 1px rgba(0,0,0,.3))}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}} .blink .bulb{animation:blink .35s linear infinite}

/* –∫–Ω–æ–ø–∫–∞, –∏–Ω—Ñ–æ */
.spin-btn{display:flex;align-items:center;justify-content:center;gap:10px;padding:14px 18px;border-radius:14px;
  text-decoration:none;font-weight:900;font-size:16px;letter-spacing:.3px;color:#111;border:1px solid #000;
  background:linear-gradient(135deg,var(--btn-grad-from) 0%,#e11e3a 35%,#ff3b5f 70%,var(--btn-grad-to) 100%);
  box-shadow:0 0 10px rgba(255,61,112,.35),0 0 20px rgba(255,110,169,.25),var(--shadow);transition:transform .12s ease,box-shadow .12s ease}
.spin-btn:active{transform:translateY(1px) scale(.985);box-shadow:var(--inset)}
.spin-btn[disabled]{opacity:.6;filter:grayscale(.2);cursor:not-allowed}

.status-row{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center}
.timer-pill{padding:8px 10px;border-radius:12px;background:#fff;color:#333;font-weight:800;font-size:13px;box-shadow:var(--shadow)}
.copy-row{display:flex;gap:8px;align-items:center;justify-content:flex-end}
.code{padding:8px 10px;border-radius:12px;background:#fff;box-shadow:var(--shadow);
  font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-weight:800;font-size:13px;color:#111}
.copy-btn{padding:8px 12px;border-radius:10px;background:#111;color:#fff;font-weight:800;text-decoration:none;box-shadow:0 2px 0 rgba(0,0,0,.35),var(--shadow)}
.copy-btn:active{transform:scale(.98)}

.footer{padding:12px 16px;font-size:12px;color:#666;text-align:center}
.footer a{color:#3a3b44;font-weight:700;text-decoration:none;border-bottom:1px dashed #3a3b44}
.footer a:hover{border-bottom-style:solid}

.toast{position:fixed;left:50%;bottom:16px;transform:translate(-50%,140%);width:min(92vw,420px);z-index:60;background:var(--card);box-shadow:var(--shadow);border-radius:18px;padding:14px;transition:transform .28s ease}
.toast.show{transform:translate(-50%,0)}
.toast h4{margin:0 0 6px;font-size:16px}
.toast p{margin:0 0 10px;color:#444;font-size:14px}
.toast .row{display:flex;justify-content:space-between;gap:8px;align-items:center}
.tg-btn{display:inline-flex;align-items:center;gap:8px;text-decoration:none;background:#111;color:#fff;padding:10px 12px;border-radius:12px;font-weight:800;box-shadow:0 2px 0 rgba(0,0,0,.35),var(--shadow)}
.tg-btn svg{width:18px;height:18px;display:block}
.toast .close{border:none;background:transparent;font-size:20px;line-height:1;cursor:pointer;padding:6px 8px;border-radius:10px}
.toast .close:active{background:#eee}

/* Drawer (–∫–∞–∫ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö) */
.drawer-wrap{position:fixed;inset:0;display:none;z-index:50}
.drawer-wrap.active{display:block}
.backdrop{position:absolute;inset:0;background:rgba(0,0,0,.25);backdrop-filter:blur(6px)}
.drawer{position:absolute;left:0;top:0;height:100%;width:min(84vw,340px);background:rgba(240,240,243,.85);
  backdrop-filter:blur(15px);box-shadow:12px 0 28px rgba(0,0,0,.15);border-top-right-radius:20px;border-bottom-right-radius:20px;
  padding:22px 20px 18px;transform:translateX(-100%);transition:transform .25s ease}
.drawer-wrap.active .drawer{transform:none}
.drawer h2{margin:0 0 14px;font-size:18px}
.m-link{display:block;padding:12px 10px;margin-bottom:8px;background:#fff;border-radius:12px;box-shadow:var(--shadow);
  text-decoration:none;color:#2f2f36;font-weight:600}
</style>
</head>
<body>
<main class="phone">
  <div class="status">
    <a class="back" href="index.html">‚Üê –ù–∞–∑–∞–¥</a>
    <div></div>
    <button class="menu-btn" id="menuBtn" aria-label="–ú–µ–Ω—é"><span></span><span></span><span></span></button>
  </div>

  <section class="wrap">
    <h1 class="headline">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –∫–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã</h1>
    <p class="sub">–ö—Ä—É—Ç–∏—Ç–µ –∫–æ–ª–µ—Å–æ 1 —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –∫—É–ø–æ–Ω. –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –ø–æ –Ω–∞—Å—Ç–æ—è—â–µ–º—É —É–≥–ª—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å—Ç—Ä–µ–ª–∫–∏.</p>

    <div class="card">
      <div class="wheel-wrap">
        <div class="wheel-box">
          <div class="pointer" aria-hidden="true"></div>
          <svg id="wheelSVG" viewBox="0 0 1000 1000" width="100%" height="100%" style="display:block"></svg>
        </div>
      </div>

      <button id="spinBtn" class="spin-btn">–ö–†–£–¢–ò–¢–¨</button>

      <div class="status-row">
        <div class="timer-pill"><span id="timer">–î–æ—Å—Ç—É–ø–Ω–æ —Å–µ–π—á–∞—Å</span></div>
        <div class="copy-row">
          <div class="code" id="couponCode">–ö—É–ø–æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</div>
          <button class="copy-btn" id="copyBtn" disabled>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer">–°–¥–µ–ª–∞–Ω–æ —Å üíõ ‚Ä¢ <a href="https://t.me/" target="_blank" rel="noopener">–Ω–∞—à TELEGRAM</a></footer>
</main>

<!-- Drawer -->
<div class="drawer-wrap" id="drawer">
  <div class="backdrop" id="backdrop"></div>
  <aside class="drawer" role="dialog" aria-label="–ú–µ–Ω—é">
    <h2>–ú–µ–Ω—é</h2>
    <a class="m-link" href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
    <a class="m-link" href="fortune.html">–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã</a>
    <a class="m-link" href="calc.html">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Ö–æ–¥–∞</a>
    <a class="m-link" href="jobs.html">–í–∞–∫–∞–Ω—Å–∏–∏</a>
  </aside>
</div>

<div class="toast" id="toast">
  <div class="row">
    <h4 id="toastTitle">–°–æ–æ–±—â–µ–Ω–∏–µ</h4>
    <button class="close" id="toastClose" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
  </div>
  <p id="toastText"></p>
  <a href="https://t.me/" target="_blank" rel="noopener" class="tg-btn" id="toastBtn" style="display:none">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="#fff" d="M9.04 15.46 8.7 18.88c.48 0 .76-.2 1.06-.47l2.55-2.35 5.18 3.68c.98.62 1.67.31 1.95-.92l3.62-16.9c.26-1.22-.43-1.68-1.39-1.31L1.3 9.06C.14 9.52.15 10.22 1 10.5–ª5.36 1.67–õ19 4.33c.61-.36 1.08-.16.69.22L9.04 15.46Z"/></svg>
    –û–ø–µ—Ä–∞—Ç–æ—Ä
  </a>
</div>

<script>
/* ===== –ë—É—Ä–≥–µ—Ä ===== */
const btn=document.getElementById('menuBtn');
const drawer=document.getElementById('drawer');
const backdrop=document.getElementById('backdrop');
btn.addEventListener('click',()=>drawer.classList.add('active'));
backdrop.addEventListener('click',()=>drawer.classList.remove('active'));
window.addEventListener('keydown',e=>{ if(e.key==='Escape') drawer.classList.remove('active'); });

/* ===== –ì–µ–æ–º–µ—Ç—Ä–∏—è ===== */
const N = 12, FULL = Math.PI*2, STEP = FULL/N;
const CENTER = {x:500, y:500};
/* –í–Ω–µ—à–Ω–µ–µ –∫–æ–ª—å—Ü–æ —Å —É—á—ë—Ç–æ–º —Ç–æ–ª—â–∏–Ω—ã –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ viewBox */
const R_RING1 = 482;  // 482 + (36/2) = 500 ‚Äî –∫—Ä–∞–π —Ä–æ–≤–Ω–æ –ø–æ –≥—Ä–∞–Ω–∏—Ü–µ
const R_RING2 = 480;
const R_BULB  = 484;
/* –ö–ª–∏–Ω—å—è —á—É—Ç—å –∑–∞—Ö–æ–¥—è—Ç –ø–æ–¥ –∑–æ–ª–æ—Ç–æ ‚Äî –±–µ–∑ –±–µ–ª–æ–π —â–µ–ª–∏ */
const R_OUT   = 469;
const R_TEXT  = 360;

const PRIZES = [
  { label:'500‚ÇΩ',  type:'coupon', value:'500'  },
  { label:'–ü–£–°–¢–û', type:'none'                 },
  { label:'700‚ÇΩ',  type:'coupon', value:'700'  },
  { label:'900‚ÇΩ',  type:'coupon', value:'900'  },
  { label:'–ü–£–°–¢–û', type:'none'                 },
  { label:'1200‚ÇΩ', type:'coupon', value:'1200' },
  { label:'1500‚ÇΩ', type:'coupon', value:'1500' },
  { label:'–ü–£–°–¢–û', type:'none'                 },
  { label:'2000‚ÇΩ', type:'coupon', value:'2000' },
  { label:'300‚ÇΩ',  type:'coupon', value:'300'  },
  { label:'1100‚ÇΩ', type:'coupon', value:'1100' },
  { label:'–°–Æ–†–ü–†–ò–ó', type:'coupon', value:'SP' },
];

const toDeg = r => r*180/Math.PI;
const polar = (r,a)=>[CENTER.x+r*Math.cos(a), CENTER.y+r*Math.sin(a)];
function wedgePath(r,a0,a1){
  const [x0,y0]=polar(r,a0), [x1,y1]=polar(r,a1);
  const la = (a1-a0)>Math.PI ? 1 : 0;
  return `M ${CENTER.x},${CENTER.y} L ${x0},${y0} A ${r},${r} 0 ${la} 1 ${x1},${y1} Z`;
}

/* ===== –†–∏—Å—É–µ–º SVG ===== */
const svg = document.getElementById('wheelSVG');
const g   = document.createElementNS('http://www.w3.org/2000/svg','g'); g.id='wheelGroup';

const colors=['#941f12','#a82316','#b82719','#cd2c1d'];
for(let i=0;i<N;i++){
  const a0=-Math.PI/2+i*STEP, a1=a0+STEP, mid=(a0+a1)/2;
  const p=document.createElementNS('http://www.w3.org/2000/svg','path');
  p.setAttribute('d',wedgePath(R_OUT,a0,a1));
  p.setAttribute('fill',colors[i%colors.length]);
  p.setAttribute('stroke','#7d170f'); p.setAttribute('stroke-width','2');
  g.appendChild(p);

  const [tx,ty]=polar(R_TEXT, mid);
  const t=document.createElementNS('http://www.w3.org/2000/svg','text');
  t.setAttribute('x',tx); t.setAttribute('y',ty);
  t.setAttribute('fill','#ffd86b'); t.setAttribute('font-weight','900');
  const label=PRIZES[i].label;
  const fs=label.length>6?32:label.length>4?36:40;
  t.setAttribute('font-size',fs);
  t.setAttribute('text-anchor','middle'); t.setAttribute('dominant-baseline','middle');
  t.setAttribute('transform',`rotate(${toDeg(mid)} ${tx} ${ty})`);
  t.textContent=label;
  g.appendChild(t);
}
svg.appendChild(g);

/* –ó–æ–ª–æ—Ç—ã–µ –∫–æ–ª—å—Ü–∞ –∏ –ª–∞–º–ø–æ—á–∫–∏ —Å–≤–µ—Ä—Ö—É */
[['#b86a00',36,R_RING1],['#e3a300',24,R_RING2]].forEach(([color,w,r])=>{
  const c=document.createElementNS('http://www.w3.org/2000/svg','circle');
  c.setAttribute('cx',CENTER.x); c.setAttribute('cy',CENTER.y); c.setAttribute('r',r);
  c.setAttribute('fill','none'); c.setAttribute('stroke',color); c.setAttribute('stroke-width',w);
  svg.appendChild(c);
});
for(let i=0;i<36;i++){ const a=i*(FULL/36); const [x,y]=polar(R_BULB,a);
  const bulb=document.createElementNS('http://www.w3.org/2000/svg','circle');
  bulb.setAttribute('class','bulb'); bulb.setAttribute('r','12'); bulb.setAttribute('cx',x); bulb.setAttribute('cy',y);
  svg.appendChild(bulb);
}

/* —Ü–µ–Ω—Ç—Ä */
[['90','#e3a300'],['60','#ffd86b']].forEach(([r,c])=>{
  const cc=document.createElementNS('http://www.w3.org/2000/svg','circle');
  cc.setAttribute('cx',CENTER.x); cc.setAttribute('cy',CENTER.y); cc.setAttribute('r',r); cc.setAttribute('fill',c); svg.appendChild(cc);
});

/* ===== –õ–æ–≥–∏–∫–∞/–∑–≤—É–∫ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ===== */
let AC; function ensureAC(){ if(!AC){ try{ AC=new (window.AudioContext||window.webkitAudioContext)(); }catch(e){} } }
function wood({freq=500,duration=90,gain=0.02,type='triangle'}){ try{ ensureAC(); if(!AC) return; const o=AC.createOscillator(), g=AC.createGain(); o.type=type; o.frequency.value=freq; const t=AC.currentTime; g.gain.setValueAtTime(0,t); g.gain.linearRampToValueAtTime(gain,t+0.01); g.gain.exponentialRampToValueAtTime(0.0001,t+duration/1000); o.connect(g).connect(AC.destination); o.start(t); o.stop(t+duration/1000);}catch(e){} }
const tickSound=()=>wood({freq:650,duration:70,gain:0.015});
const winSound =()=>[740,880,1175].forEach((f,i)=>setTimeout(()=>wood({freq:f,duration:140,gain:0.025}),i*140));
const loseSound=()=>{wood({freq:220,duration:200,gain:0.02,type:'sine'});setTimeout(()=>wood({freq:170,duration:240,gain:0.018}),160);}

const KEY_LAST='fortune_last_spin_at_v9', KEY_COUP='fortune_last_coupon_v9', COOLDOWN=24*60*60*1000;
const spinBtn=document.getElementById('spinBtn'), timerEl=document.getElementById('timer'), couponEl=document.getElementById('couponCode'), copyBtn=document.getElementById('copyBtn');
const toast=document.getElementById('toast'), toastTitle=document.getElementById('toastTitle'), toastText=document.getElementById('toastText'), toastBtn=document.getElementById('toastBtn');
document.getElementById('toastClose').onclick=()=>toast.classList.remove('show');
const pad2=n=>String(n).padStart(2,'0');
const leftFmt=ms=>`${pad2(Math.floor(ms/3600000))}:${pad2(Math.floor((ms%3600000)/60000))}:${pad2(Math.floor((ms%60000)/1000))}`;
const setCoupon=(t,copy)=>{couponEl.textContent=t; copyBtn.disabled=!copy;}
const last=()=>Number(localStorage.getItem(KEY_LAST))||0;
const left =()=>Math.max(0,last()+COOLDOWN-Date.now());
(function tick(){const l=left(); if(l>0){timerEl.textContent='–°–ª–µ–¥—É—é—â–µ–µ —á–µ—Ä–µ–∑ '+leftFmt(l); spinBtn.disabled=true; requestAnimationFrame(tick);} else {timerEl.textContent='–î–æ—Å—Ç—É–ø–Ω–æ —Å–µ–π—á–∞—Å'; spinBtn.disabled=false;}})();
const saved=localStorage.getItem(KEY_COUP); if(saved) setCoupon(`–ö—É–ø–æ–Ω ‚Äî ${saved}`,true);

let rotation=0, spinning=false;
function applyRotation(){ document.getElementById('wheelGroup').setAttribute('transform',`rotate(${rotation*180/Math.PI} ${CENTER.x} ${CENTER.y})`); }
function spin(){
  if(spinning) return;
  const l=Math.max(0,(Number(localStorage.getItem(KEY_LAST))||0)+COOLDOWN-Date.now());
  if(l>0) return;
  ensureAC(); spinning=true; setCoupon('–ö—Ä—É—Ç–∏–º –∫–æ–ª–µ—Å–æ‚Ä¶',false);

  const minTurns=4, maxTurns=7;
  const target = rotation + (minTurns + Math.random()*(maxTurns-minTurns)) * Math.PI*2;
  const dur = 3600 + Math.random()*1200;
  const start = performance.now(), startA=rotation;
  const ease=t=>1-Math.pow(1-t,3);

  function frame(now){
    const t=Math.min(1,(now-start)/dur);
    rotation = ((startA + (target-startA)*ease(t))%(Math.PI*2)+Math.PI*2)%(Math.PI*2);
    applyRotation();
    if(t<1){ requestAnimationFrame(frame); }
    else{
      rotation = ((rotation%(Math.PI*2))+Math.PI*2)%(Math.PI*2); applyRotation();
      const idx = Math.floor(((Math.PI - rotation + Math.PI*2)%(Math.PI*2))/STEP)%N;
      const prize = PRIZES[idx];
      if(prize.type==='none'){
        setCoupon('–£–≤—ã, –ø—É—Å—Ç–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≤—Ç—Ä–∞!',false);
      }else{
        const A='ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; let r=''; for(let i=0;i<6;i++) r+=A[Math.floor(Math.random()*A.length)];
        const amount = prize.value==='SP'?'–°–Æ–†–ü–†–ò–ó':`${prize.value}‚ÇΩ`;
        const code = prize.value==='SP'?`SP-${r}`:`D${prize.value}-${r}`;
        setCoupon(`${amount} ‚Äî ${code}`, true);
        localStorage.setItem(KEY_COUP, code);
      }
      localStorage.setItem(KEY_LAST,String(Date.now()));
      spinning=false;
    }
  }
  requestAnimationFrame(frame);
}
document.getElementById('spinBtn').addEventListener('click',spin);
document.getElementById('copyBtn').addEventListener('click',e=>{
  const t=document.getElementById('couponCode').textContent.trim();
  if(!t||t.includes('–ø–æ—è–≤–∏—Ç—Å—è')||t.includes('–ø—É—Å—Ç–æ')) return;
  navigator.clipboard.writeText(t).then(()=>{
    const old=e.target.textContent; e.target.textContent='–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ'; setTimeout(()=>e.target.textContent=old,900);
  });
});

/* —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä–µ–Ω–¥–µ—Ä */
applyRotation();
</script>
</body>
</html>
