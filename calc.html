<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Калькулятор дохода — чай</title>
<style>
:root{
  --bg:#f0f0f3; --card:#f7f7fb; --ink:#2f2f36;
  --shadow:5px 5px 10px #cfcfd6, -5px -5px 10px #ffffff;
  --inset:inset 5px 5px 10px #cfcfd6, inset -5px -5px 10px #ffffff;
  --maxw:428px; --gap:12px;
  --accent:#ff6ea9; --ink-soft:#565764;
}

/* БАЗА */
html,body{height:100%}
body{
  margin:0;background:var(--bg);color:var(--ink);
  font:15px/1.45 -apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Arial;
  -webkit-font-smoothing:antialiased;overflow-x:hidden;
}
.phone{
  width:min(100vw,var(--maxw));margin:0 auto;min-height:100dvh;
  background:var(--bg);box-shadow:var(--shadow);border-radius:24px;overflow:hidden;
  display:flex;flex-direction:column;
}
.status{height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 16px}
.center{background:var(--bg);box-shadow:var(--shadow);border-radius:18px;padding:8px 14px;font-weight:700;font-size:12px;color:#5b5c64}
.back{display:inline-block;text-decoration:none;font-weight:700;color:#2f2f36;background:#fff;padding:8px 12px;border-radius:12px;box-shadow:var(--shadow)}
.wrap{padding:12px 16px 22px}

/* ЗАГОЛОВОК */
h1{margin:6px 0 10px;font-weight:900;font-size:clamp(22px,6vw,30px);line-height:1.08;color:#fff5e6;
  text-shadow:0 0 4px #ffd1ff,0 0 10px #c5113a,0 0 22px #7b2cff,0 0 32px #b34bff;}
.sub{margin:4px 0 14px;color:var(--ink-soft)}

/* КАРТОЧКА ФОРМЫ */
.card{background:var(--card);box-shadow:var(--shadow);border-radius:20px;padding:16px;display:grid;gap:14px}

/* БЛОКИ */
.block h3{margin:0 0 8px;font-size:13px;color:#3c3d46;letter-spacing:.2px}
.row{display:flex;gap:10px;flex-wrap:wrap}

/* КНОПКИ-ЧИПЫ */
.chip{
  appearance:none;border:none;background:var(--bg);box-shadow:var(--shadow);
  color:#2f2f36;border-radius:14px;padding:10px 14px;font-weight:800;cursor:pointer;
}
.chip[data-active="1"]{background:#111;color:#fff;box-shadow:var(--inset)}
/* селект */
.select{display:flex;align-items:center;gap:8px}
.select select{
  width:100%;appearance:none;border:none;background:var(--bg);box-shadow:var(--shadow);
  padding:12px 14px;border-radius:14px;font-weight:800;color:#2f2f36;
}

/* ИНПУТ-ЧИСЛО */
.counter{display:flex;align-items:center;gap:10px}
.counter input{
  width:86px;appearance:textfield;border:none;background:var(--bg);box-shadow:var(--shadow);
  padding:10px 12px;border-radius:12px;font-weight:900;text-align:center
}
.counter small{color:#666}

/* РЕЗУЛЬТАТ */
.result{
  background:#111;color:#fff;border-radius:18px;padding:16px;display:grid;gap:8px;
  box-shadow:0 0 10px rgba(0,0,0,.35), var(--shadow)
}
.result h4{margin:0;font-size:14px;opacity:.8}
.total{font-size:22px;font-weight:900}
.note{font-size:12px;opacity:.8}

/* КНОПКА */
.btn{
  display:inline-flex;align-items:center;justify-content:center;
  padding:12px 16px;border-radius:14px;background:linear-gradient(135deg,#c5113a 0%,#e11e3a 35%,#ff3b5f 70%,#ff6ea9 100%);
  color:#111;font-weight:900;text-decoration:none;border:1px solid #000;box-shadow:var(--shadow)
}
.btn:active{box-shadow:var(--inset);transform:translateY(1px)}

/* Мелочи */
hr{height:1px;border:none;background:#e8e8ef;margin:4px 0}
.help{font-size:12px;color:#6b6c75}
</style>
</head>
<body>
<main class="phone">
  <div class="status">
    <a class="back" href="index.html">← Назад</a>
    <div class="center">TELEGRAM</div>
    <span style="width:48px"></span>
  </div>

  <section class="wrap">
    <h1>Калькулятор дохода</h1>
    <p class="sub">Посчитай заработок по товару, весу и доплатам. Ограничения: до 100 упаковок в день и 1–7 рабочих дней в неделю.</p>

    <div class="card" id="form">
      <!-- ТОВАР -->
      <div class="block">
        <h3>Товар</h3>
        <div class="select">
          <select id="product">
            <option value="shu">Шу пуэр</option>
            <option value="puer">Пуэр</option>
            <option value="tgy">Тигуаньинь</option>
            <option value="china">Рассыпной китайский</option>
          </select>
        </div>
      </div>

      <!-- КТО ФАСУЕТ -->
      <div class="block">
        <h3>Кто фасует?</h3>
        <div class="row" id="whoWrap">
          <button class="chip" data-name="self" data-active="1">САМ</button>
          <button class="chip" data-name="not">НЕ САМ</button>
        </div>
        <div class="help">Если фасуешь сам — доплата +50₽ за упаковку.</div>
      </div>

      <!-- ТИП КОРПУСА -->
      <div class="block">
        <h3>Тип упаковки (корпус)</h3>
        <div class="row" id="packWrap">
          <button class="chip" data-pack="none" data-active="1">Без</button>
          <button class="chip" data-pack="metal">Металл +50₽</button>
          <button class="chip" data-pack="stone">Каменный +30₽</button>
        </div>
      </div>

      <!-- ВЕС (под товар) -->
      <div class="block">
        <h3>Вес упаковки</h3>
        <div class="row" id="weightWrap"><!-- сюда подставятся варианты --></div>
      </div>

      <!-- КОЛИЧЕСТВО / ДНИ -->
      <div class="block">
        <h3>Количество упаковок в день</h3>
        <div class="counter">
          <input type="number" id="qty" value="10" min="1" max="100" />
          <small>Доступно от 1 до 100</small>
        </div>
      </div>

      <div class="block">
        <h3>Дней работы в неделю</h3>
        <div class="counter">
          <input type="number" id="days" value="7" min="1" max="7" />
          <small>Доступно от 1 до 7</small>
        </div>
      </div>

      <hr>

      <!-- РЕЗУЛЬТАТ -->
      <div class="result" id="resultBox">
        <h4>Ваш месячный доход:</h4>
        <div class="total" id="total">0 ₽ / месяц</div>
        <div class="note" id="breakdown">—</div>
      </div>

      <a href="#" class="btn" id="recalcBtn">Рассчитать доход</a>
    </div>
  </section>
</main>

<script>
/* Тарифы по ТЗ */
const PRICES = {
  shu: {                // Шу пуэр
    name: "Шу пуэр",
    weights: {"0.3":300, "0.5":400, "1.0":500, "5.0+":700}
  },
  puer:{                // Пуэр
    name: "Пуэр",
    weights: {"0.5":300, "1.0":450, "2.0":500, "5.0+":650}
  },
  tgy:{                 // Тигуаньинь
    name: "Тигуаньинь",
    weights: {"1.0":300, "2.0":400, "5.0+":600}
  },
  china:{               // Рассыпной китайский
    name: "Рассыпной китайский",
    weights: {"1":300, "2":400, "5":580}
  }
};

const FAC_SELF_BONUS = 50;          // сам фасует +50₽
const PACK_BONUS = { none:0, metal:50, stone:30 };

const weekToMonth = 4.345;          // среднее число недель в месяце

/* DOM */
const productEl = document.getElementById('product');
const weightWrap = document.getElementById('weightWrap');
const whoWrap = document.getElementById('whoWrap');
const packWrap = document.getElementById('packWrap');
const qtyEl = document.getElementById('qty');
const daysEl = document.getElementById('days');
const totalEl = document.getElementById('total');
const breakdownEl = document.getElementById('breakdown');
const recalcBtn = document.getElementById('recalcBtn');

/* helpers */
function fmt(n){
  return n.toLocaleString('ru-RU');
}
function chipify(container, attrName, value){
  [...container.querySelectorAll('.chip')].forEach(ch=>{
    ch.dataset.active = (ch.getAttribute(attrName)===value) ? "1" : "0";
  });
}
function getActiveValue(container, attrName){
  const el = container.querySelector(`.chip[${attrName}][data-active="1"]`);
  return el ? el.getAttribute(attrName) : null;
}

/* Рендер весов под выбранный товар */
function renderWeights(){
  weightWrap.innerHTML = '';
  const prod = PRICES[productEl.value];
  Object.entries(prod.weights).forEach(([w,price],i)=>{
    const b = document.createElement('button');
    b.className='chip';
    b.textContent = (w.includes('+')? w : w+' г') + ` — ${price}₽`;
    b.setAttribute('data-weight', w);
    if(i===0) b.dataset.active="1";
    b.addEventListener('click', ()=>{
      chipify(weightWrap, 'data-weight', w);
      calc();
    });
    weightWrap.appendChild(b);
  });
}

/* клики по чипам */
whoWrap.addEventListener('click', e=>{
  const btn=e.target.closest('.chip'); if(!btn) return;
  chipify(whoWrap,'data-name', btn.getAttribute('data-name'));
  calc();
});
packWrap.addEventListener('click', e=>{
  const btn=e.target.closest('.chip'); if(!btn) return;
  chipify(packWrap,'data-pack', btn.getAttribute('data-pack'));
  calc();
});
productEl.addEventListener('change',()=>{ renderWeights(); calc(); });
qtyEl.addEventListener('input',()=>{ clampNum(qtyEl,1,100); calc(); });
daysEl.addEventListener('input',()=>{ clampNum(daysEl,1,7); calc(); });
recalcBtn.addEventListener('click', e=>{ e.preventDefault(); calc(); });

function clampNum(el,min,max){
  let v = parseInt(el.value||0,10);
  if(isNaN(v)) v=min;
  v=Math.max(min,Math.min(max,v));
  el.value=v;
}

/* Расчёт */
function calc(){
  const prod = PRICES[productEl.value];
  const weightKey = getActiveValue(weightWrap,'data-weight');
  const base = prod.weights[weightKey];          // базовая цена за одну

  const self = (getActiveValue(whoWrap,'data-name')==='self') ? FAC_SELF_BONUS : 0;
  const pack = PACK_BONUS[getActiveValue(packWrap,'data-pack')];

  const perItem = base + self + pack;

  const qty = parseInt(qtyEl.value,10) || 0;
  const days = parseInt(daysEl.value,10) || 0;

  const perDay = perItem * qty;
  const perWeek = perDay * days;
  const perMonth = Math.round(perWeek * weekToMonth);

  totalEl.textContent = `${fmt(perMonth)} ₽ / месяц`;
  breakdownEl.textContent =
    `${prod.name}: ${weightKey} — база ${fmt(base)}₽, `+
    `доплаты: фасовка ${fmt(self)}₽, корпус ${fmt(pack)}₽; `+
    `в день ${qty} шт × ${fmt(perItem)}₽ = ${fmt(perDay)}₽; `+
    `в неделю ${days} дн = ${fmt(perWeek)}₽; ~${fmt(perMonth)}₽/мес.`;
}

/* init */
renderWeights();
calc();
</script>
</body>
</html>
