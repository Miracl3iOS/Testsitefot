<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Калькулятор дохода — чай</title>
<style>
:root{
  --bg:#f0f0f3; --card:#f7f7fb; --ink:#2f2f36;
  --shadow:5px 5px 10px #cfcfd6, -5px -5px 10px #ffffff;
  --inset:inset 5px 5px 10px #cfcfd6, inset -5px -5px 10px #ffffff;
  --maxw:428px; --gap:12px;
  --ink-soft:#565764;
}

/* БАЗА */
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);
  font:15px/1.45 -apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Arial;
  -webkit-font-smoothing:antialiased;overflow-x:hidden}
.phone{width:min(100vw,var(--maxw));margin:0 auto;min-height:100dvh;background:var(--bg);
  box-shadow:var(--shadow);border-radius:24px;overflow:hidden;display:flex;flex-direction:column}

/* Верхняя панель (бургер) */
.status{height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 16px}
.menu-btn{width:48px;height:34px;border:none;border-radius:12px;background:var(--bg);box-shadow:var(--shadow);
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:5px;cursor:pointer}
.menu-btn span{width:22px;height:2.5px;background:#000;border-radius:3px}

/* Drawer */
.drawer-wrap{position:fixed;inset:0;display:none;z-index:50}
.drawer-wrap.active{display:block}
.backdrop{position:absolute;inset:0;background:rgba(0,0,0,.25);backdrop-filter:blur(6px)}
.drawer{position:absolute;left:0;top:0;height:100%;width:min(84vw,340px);background:rgba(240,240,243,.85);
  backdrop-filter:blur(15px);box-shadow:12px 0 28px rgba(0,0,0,.15);border-top-right-radius:20px;border-bottom-right-radius:20px;
  padding:22px 20px 18px;transform:translateX(-100%);transition:transform .25s ease}
.drawer-wrap.active .drawer{transform:none}
.drawer h2{margin:0 0 14px;font-size:18px}
.m-link{display:block;padding:12px 10px;margin-bottom:8px;background:#fff;border-radius:12px;box-shadow:var(--shadow);
  text-decoration:none;color:#2f2f36;font-weight:600}

.wrap{padding:12px 16px 22px}

/* Заголовок — «чёрный неон» */
h1{
  margin:6px 0 12px;font-weight:900;font-size:clamp(22px,6vw,30px);line-height:1.08;color:#111;
  text-shadow:0 0 3px rgba(0,0,0,.35), 0 0 8px rgba(0,0,0,.25), 0 0 16px rgba(0,0,0,.2);
}
.sub{margin:4px 0 14px;color:var(--ink-soft)}

/* Две верхние кнопки */
.top-actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px}
.action{display:flex;align-items:center;justify-content:center;gap:10px;
  background:var(--card);box-shadow:var(--shadow);border-radius:14px;padding:12px;text-decoration:none;color:#2f2f36;font-weight:900}
.action.tg{background:linear-gradient(135deg,#111 0%,#1c1c1c 100%);color:#fff}
.action .tg-icon{width:18px;height:18px;background:url('telegram.png') center/contain no-repeat;filter:invert(1)}

/* Карточка формы */
.card{background:var(--card);box-shadow:var(--shadow);border-radius:20px;padding:16px;display:grid;gap:14px}
.block h3{margin:0 0 8px;font-size:13px;color:#3c3d46;letter-spacing:.2px}
.row{display:flex;gap:10px;flex-wrap:wrap}

/* селект */
.select select{width:100%;appearance:none;border:none;background:var(--bg);box-shadow:var(--shadow);
  padding:12px 14px;border-radius:14px;font-weight:800;color:#2f2f36}

/* чипы */
.chip{appearance:none;border:none;background:var(--bg);box-shadow:var(--shadow);color:#2f2f36;border-radius:14px;
  padding:10px 14px;font-weight:800;cursor:pointer}
.chip[data-active="1"]{background:#111;color:#fff;box-shadow:var(--inset)}

/* числа */
.counter{display:flex;align-items:center;gap:10px}
.counter input{width:86px;appearance:textfield;border:none;background:var(--bg);box-shadow:var(--shadow);
  padding:10px 12px;border-radius:12px;font-weight:900;text-align:center}
.counter small{color:#666}

/* кнопка расчёта — зелёный градиент */
.btn{
  display:inline-flex;align-items:center;justify-content:center;padding:12px 16px;border-radius:14px;
  background:linear-gradient(135deg,#099268 0%,#12b886 50%,#2fefb5 100%);color:#111;font-weight:900;text-decoration:none;
  border:1px solid #000;box-shadow:var(--shadow)
}
.btn:active{box-shadow:var(--inset);transform:translateY(1px)}

/* результат */
.result{background:#111;color:#fff;border-radius:18px;padding:16px;display:grid;gap:8px;
  box-shadow:0 0 10px rgba(0,0,0,.35), var(--shadow)}
.result h4{margin:0;font-size:14px;opacity:.8}
.total{font-size:22px;font-weight:900}
.note{font-size:12px;opacity:.8}

hr{height:1px;border:none;background:#e8e8ef;margin:4px 0}
.help{font-size:12px;color:#6b6c75}
</style>
</head>
<body>
<main class="phone">
  <div class="status">
    <div style="width:48px"></div>
    <div style="width:48px"></div>
    <button class="menu-btn" id="menuBtn" aria-label="Меню"><span></span><span></span><span></span></button>
  </div>

  <section class="wrap">
    <h1>Калькулятор дохода</h1>
    <p class="sub">Введи параметры — увидишь ориентировочный доход. По умолчанию всё нули, пока не выберешь товар и условия.</p>

    <!-- Верхние действия -->
    <div class="top-actions">
      <a href="#" class="action">Вакансии</a>
      <a href="https://t.me/" target="_blank" rel="noopener" class="action tg">
        <span class="tg-icon" aria-hidden="true"></span> Начать работу
      </a>
    </div>

    <div class="card" id="form">
      <!-- ТОВАР -->
      <div class="block">
        <h3>Товар</h3>
        <div class="select">
          <select id="product">
            <option value="" selected disabled>Выберите товар…</option>
            <option value="shu">Шу пуэр</option>
            <option value="puer">Пуэр</option>
            <option value="tgy">Тигуаньинь</option>
            <option value="china">Рассыпной китайский</option>
          </select>
        </div>
      </div>

      <!-- КТО ФАСУЕТ -->
      <div class="block">
        <h3>Кто фасует?</h3>
        <div class="row" id="whoWrap">
          <button class="chip" data-name="self">САМ</button>
          <button class="chip" data-name="not">НЕ САМ</button>
        </div>
        <div class="help">Если фасуешь сам — доплата +50₽ за упаковку.</div>
      </div>

      <!-- ТИП КОРПУСА -->
      <div class="block">
        <h3>Тип упаковки (корпус)</h3>
        <div class="row" id="packWrap">
          <button class="chip" data-pack="none">Без</button>
          <button class="chip" data-pack="metal">Металл +50₽</button>
          <button class="chip" data-pack="stone">Каменный +30₽</button>
        </div>
      </div>

      <!-- ВЕС -->
      <div class="block">
        <h3>Вес упаковки</h3>
        <div class="row" id="weightWrap"><!-- варианты появятся после выбора товара --></div>
      </div>

      <!-- КОЛИЧЕСТВО / ДНИ -->
      <div class="block">
        <h3>Количество упаковок в день</h3>
        <div class="counter">
          <input type="number" id="qty" value="0" min="0" max="100" />
          <small>0–100</small>
        </div>
      </div>

      <div class="block">
        <h3>Дней работы в неделю</h3>
        <div class="counter">
          <input type="number" id="days" value="0" min="0" max="7" />
          <small>0–7</small>
        </div>
      </div>

      <hr>

      <!-- РЕЗУЛЬТАТ -->
      <div class="result" id="resultBox">
        <h4>Ваш месячный доход:</h4>
        <div class="total" id="total">0 ₽ / месяц</div>
        <div class="note" id="breakdown">Выбери товар и параметры.</div>
      </div>

      <a href="#" class="btn" id="recalcBtn">Рассчитать доход</a>
    </div>
  </section>
</main>

<!-- Drawer -->
<div class="drawer-wrap" id="drawer">
  <div class="backdrop" id="backdrop"></div>
  <aside class="drawer" role="dialog" aria-label="Меню">
    <h2>Меню</h2>
    <a class="m-link" href="index.html">Главная</a>
    <a class="m-link" href="fortune.html">Колесо фортуны</a>
    <a class="m-link" href="calc.html">Калькулятор дохода</a>
  </aside>
</div>

<script>
/* Бургер */
const btn=document.getElementById('menuBtn');
const drawer=document.getElementById('drawer');
const backdrop=document.getElementById('backdrop');
btn.addEventListener('click',()=>drawer.classList.add('active'));
backdrop.addEventListener('click',()=>drawer.classList.remove('active'));
window.addEventListener('keydown',e=>{ if(e.key==='Escape') drawer.classList.remove('active'); });

/* Тарифы */
const PRICES = {
  shu:   {name:"Шу пуэр",              weights: {"0.3":300,"0.5":400,"1.0":500,"5.0+":700}},
  puer:  {name:"Пуэр",                  weights: {"0.5":300,"1.0":450,"2.0":500,"5.0+":650}},
  tgy:   {name:"Тигуаньинь",            weights: {"1.0":300,"2.0":400,"5.0+":600}},
  china: {name:"Рассыпной китайский",   weights: {"1":300,"2":400,"5":580}}
};
const FAC_SELF_BONUS = 50;
const PACK_BONUS = {none:0, metal:50, stone:30};
const weekToMonth = 4.345;

/* DOM */
const productEl = document.getElementById('product');
const weightWrap = document.getElementById('weightWrap');
const whoWrap = document.getElementById('whoWrap');
const packWrap = document.getElementById('packWrap');
const qtyEl = document.getElementById('qty');
const daysEl = document.getElementById('days');
const totalEl = document.getElementById('total');
const breakdownEl = document.getElementById('breakdown');
const recalcBtn = document.getElementById('recalcBtn');

/* helpers */
function fmt(n){return n.toLocaleString('ru-RU')}
function chipify(container, attrName, value){
  [...container.querySelectorAll('.chip')].forEach(ch=>{
    ch.dataset.active = (ch.getAttribute(attrName)===value) ? "1" : "0";
  });
}
function getActiveValue(container, attrName){
  const el = container.querySelector(`.chip[${attrName}][data-active="1"]`);
  return el ? el.getAttribute(attrName) : null;
}
function clampNum(el,min,max){
  let v = parseInt(el.value||0,10);
  if(isNaN(v)) v=0;
  v=Math.max(min,Math.min(max,v));
  el.value=v;
}

/* рендер весов */
function renderWeights(){
  weightWrap.innerHTML='';
  const key = productEl.value;
  if(!key){calc(); return;}
  const prod = PRICES[key];
  Object.entries(prod.weights).forEach(([w,price])=>{
    const b=document.createElement('button');
    b.className='chip';
    b.textContent=(w.includes('+')? w : w+' г')+` — ${price}₽`;
    b.setAttribute('data-weight', w);
    b.addEventListener('click',()=>{ chipify(weightWrap,'data-weight',w); calc(); });
    weightWrap.appendChild(b);
  });
}

/* события */
productEl.addEventListener('change',()=>{ renderWeights(); calc(); });
whoWrap.addEventListener('click',e=>{
  const btn=e.target.closest('.chip'); if(!btn) return;
  chipify(whoWrap,'data-name',btn.getAttribute('data-name')); calc();
});
packWrap.addEventListener('click',e=>{
  const btn=e.target.closest('.chip'); if(!btn) return;
  chipify(packWrap,'data-pack',btn.getAttribute('data-pack')); calc();
});
qtyEl.addEventListener('input',()=>{ clampNum(qtyEl,0,100); calc(); });
daysEl.addEventListener('input',()=>{ clampNum(daysEl,0,7); calc(); });
recalcBtn.addEventListener('click',e=>{ e.preventDefault(); calc(); });

/* расчёт */
function calc(){
  const prodKey = productEl.value;
  const weightKey = getActiveValue(weightWrap,'data-weight');
  const self = (getActiveValue(whoWrap,'data-name')==='self') ? FAC_SELF_BONUS : 0;
  const hasPack = getActiveValue(packWrap,'data-pack');
  const pack = hasPack ? PACK_BONUS[hasPack] : 0;
  const qty = parseInt(qtyEl.value,10)||0;
  const days = parseInt(daysEl.value,10)||0;

  if(!prodKey || !weightKey || (!hasPack && hasPack!=="none") || (!whoWrap.querySelector('.chip[data-active="1"]'))){
    totalEl.textContent = `0 ₽ / месяц`;
    breakdownEl.textContent = `Выбери товар, фасовку, упаковку, вес и введи количество / дни.`;
    return;
  }

  const base = PRICES[prodKey].weights[weightKey];
  const perItem = base + self + pack;
  const perDay = perItem * qty;
  const perWeek = perDay * days;
  const perMonth = Math.round(perWeek * weekToMonth);

  totalEl.textContent = `${fmt(perMonth)} ₽ / месяц`;
  breakdownEl.textContent =
    `${PRICES[prodKey].name}: ${weightKey} — база ${fmt(base)}₽; доплаты: фасовка ${fmt(self)}₽, корпус ${fmt(pack)}₽; `+
    `в день ${qty} × ${fmt(perItem)}₽ = ${fmt(perDay)}₽; в неделю ${days} дн = ${fmt(perWeek)}₽.`;
}

/* init — всё нули, без выбора */
renderWeights();
calc();
</script>
</body>
</html>
